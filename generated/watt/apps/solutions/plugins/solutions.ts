// @generated by flusk-lang â€” DO NOT EDIT

import { type FastifyInstance } from 'fastify';
import fp from 'fastify-plugin';

import { listSolutions } from '../functions/listSolutions.js';
import { getSolution } from '../functions/getSolution.js';
import { createSolution } from '../functions/createSolution.js';
import { updateSolution } from '../functions/updateSolution.js';
import { deleteSolution } from '../functions/deleteSolution.js';
import { testSolution } from '../functions/testSolution.js';
import { publishSolution } from '../functions/publishSolution.js';
import { unpublishDeployment } from '../functions/unpublishDeployment.js';
import { listDeployments } from '../functions/listDeployments.js';
import { uploadKnowledge } from '../functions/uploadKnowledge.js';
import { deleteKnowledge } from '../functions/deleteKnowledge.js';
import { getSolutionUsage } from '../functions/getSolutionUsage.js';
import { runSolutionSandbox } from '../functions/runSolutionSandbox.js';
import { provisionDeployment } from '../functions/provisionDeployment.js';
import { teardownDeployment } from '../functions/teardownDeployment.js';

export default fp(async (app: FastifyInstance) => {

  app.get('/api/solutions', {
    preHandler: app.auth,
  }, async (request, reply) => {
    const result = await listSolutions(app.platformatic, request);
    return reply.send(result);
  });

  app.get('/api/solutions/:solutionId', {
    preHandler: app.auth,
  }, async (request, reply) => {
    const result = await getSolution(app.platformatic, request);
    return reply.send(result);
  });

  app.post('/api/solutions', {
    schema: {
      body: {
        type: 'object',
        properties: {
          name: { type: 'string' },
          description: { type: 'string' },
          llm_provider: { type: 'string' },
          llm_model: { type: 'string' },
          system_prompt: { type: 'string' },
          temperature: { type: 'number' },
          max_tokens: { type: 'string' },
          tools_config: { type: 'string' },
        },
        required: ['name', 'llm_provider', 'llm_model'],
      },
    },
    preHandler: app.auth,
  }, async (request, reply) => {
    const result = await createSolution(app.platformatic, request);
    return reply.send(result);
  });

  app.patch('/api/solutions/:solutionId', {
    preHandler: app.auth,
  }, async (request, reply) => {
    const result = await updateSolution(app.platformatic, request);
    return reply.send(result);
  });

  app.delete('/api/solutions/:solutionId', {
    preHandler: app.auth,
  }, async (request, reply) => {
    const result = await deleteSolution(app.platformatic, request);
    return reply.send(result);
  });

  app.post('/api/solutions/:solutionId/test', {
    schema: {
      body: {
        type: 'object',
        properties: {
          message: { type: 'string' },
        },
        required: ['message'],
      },
    },
    preHandler: app.auth,
  }, async (request, reply) => {
    const result = await testSolution(app.platformatic, request);
    return reply.send(result);
  });

  app.post('/api/solutions/:solutionId/publish', {
    schema: {
      body: {
        type: 'object',
        properties: {
          channel: { type: 'string' },
          channel_config: { type: 'string' },
        },
        required: ['channel', 'channel_config'],
      },
    },
    preHandler: app.auth,
  }, async (request, reply) => {
    const result = await publishSolution(app.platformatic, request);
    return reply.send(result);
  });

  app.delete('/api/deployments/:deploymentId', {
    preHandler: app.auth,
  }, async (request, reply) => {
    const result = await unpublishDeployment(app.platformatic, request);
    return reply.send(result);
  });

  app.get('/api/deployments', {
    preHandler: app.auth,
  }, async (request, reply) => {
    const result = await listDeployments(app.platformatic, request);
    return reply.send(result);
  });

  app.post('/api/solutions/:solutionId/knowledge', {
    schema: {
      body: {
        type: 'object',
        properties: {
          name: { type: 'string' },
          type: { type: 'string' },
          source: { type: 'string' },
        },
        required: ['name', 'type', 'source'],
      },
    },
    preHandler: app.auth,
  }, async (request, reply) => {
    const result = await uploadKnowledge(app.platformatic, request);
    return reply.send(result);
  });

  app.delete('/api/solutions/:solutionId/knowledge/:kbId', {
    preHandler: app.auth,
  }, async (request, reply) => {
    const result = await deleteKnowledge(app.platformatic, request);
    return reply.send(result);
  });

  app.get('/api/solutions/:solutionId/usage', {
    preHandler: app.auth,
  }, async (request, reply) => {
    const result = await getSolutionUsage(app.platformatic, request);
    return reply.send(result);
  });
});
