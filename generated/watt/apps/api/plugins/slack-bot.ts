// @generated by flusk-lang â€” DO NOT EDIT

import type { FastifyInstance, FastifyRequest, FastifyReply } from 'fastify';
import fp from 'fastify-plugin';

import sendSlackMessage from '../functions/sendSlackMessage.js';
import slackWebhook from '../functions/slackWebhook.js';
import getSettings from '../functions/getSettings.js';

export default fp(async (app: FastifyInstance) => {

  // POST /integrations/slack/webhook
  app.post('/integrations/slack/webhook', {
  }, async (request: FastifyRequest, reply: FastifyReply) => {
    const input = {};
    return slackWebhook(app, request, reply, input);
  });

  // GET /api/slack/settings
  app.get('/api/slack/settings', {
    onRequest: [app.authenticate],
  }, async (request: FastifyRequest, reply: FastifyReply) => {
    const input = {};
    const user = request.user as { sub: number; org: number; role: string };
    Object.assign(input, { org_id: user.org, user_id: user.sub });
    return getSettings(app, request, reply, input);
  });

});
