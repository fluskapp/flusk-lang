// @generated by flusk-lang â€” DO NOT EDIT

const BASE_URL = 'http://localhost:3000';

const getToken = (): string => process.env.WHATSAPP_API_KEY ?? '';

const request = async (method: string, path: string, body?: unknown): Promise<unknown> => {
  const headers: Record<string, string> = { 'Content-Type': 'application/json' };
  headers['Authorization'] = `Bearer ${getToken()}`;
  const res = await fetch(`${BASE_URL}${path}`, {
    method,
    headers,
    ...(body ? { body: JSON.stringify(body) } : {}),
  });
  if (!res.ok) throw new Error(`${res.status} ${res.statusText}`);
  return res.json();
};

export const sendMessage = (body: Record<string, unknown>): Promise<unknown> =>
  request('POST', '/api/sendText', body);

export const getStatus = (): Promise<unknown> =>
  request('GET', '/api/sessions/status');

export const whatsappProvider = {
  sendMessage,
  getStatus,
};
