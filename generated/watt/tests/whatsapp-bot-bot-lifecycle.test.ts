// @generated by flusk-lang — DO NOT EDIT

import { test } from 'node:test';
import assert from 'node:assert/strict';
import { buildServer } from '@platformatic/service';

test('whatsapp-bot — bot-lifecycle', async () => {
  const app = await buildServer('./apps/whatsapp-bot/platformatic.json');
  await app.start();
  const baseUrl = app.url;

  // Auth: session

  {
    const res = await fetch(`${baseUrl}/api/bots`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({"name":"Test Bot","phone_number":"+1234567890","system_prompt":"You are helpful"}),
    });
    assert.equal(res.status, 200);
  }

  {
    const res = await fetch(`${baseUrl}/api/bots`, {
      method: 'GET',
    });
    assert.equal(res.status, 200);
  }

  // Assert: bots.length > 0

  await app.close();
});
